<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Frontend</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  <link href="/node_modules/bootstrap/dist/css/bootstrap.min.css">

  <!-- font awesome -->
  <link href="https://fonts.googleapis.com/css?family=Berkshire+Swash|Great+Vibes|Lobster" rel="stylesheet">  
  
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  
  <!-- Admin CSS Styles -->
     <!-- Font Awesome CSS-->
     <link rel="stylesheet" href="/assets/vendor/font-awesome/css/font-awesome.min.css">
     <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
     <!-- Fontastic Custom icon font-->
     <link rel="stylesheet" href="/assets/css/fontastic.css">
     <!-- Google fonts - Roboto -->
     <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
     <!-- jQuery Circle-->
     <link rel="stylesheet" href="/assets/css/grasp_mobile_progress_circle-1.0.0.min.css">
     <!-- Custom Scrollbar-->
     <link rel="stylesheet" href="/assets/vendor/malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.css">
     <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.css"> -->
     <!-- theme stylesheet-->
     <link rel="stylesheet" href="/assets/css/style.default.css" id="theme-stylesheet">
     <!-- Custom stylesheet - for your changes-->
    
     <link href="/assets/vendor/bootstrap/css/bootstrap.min.css">
     <link href="/assets/vendor/bootstrap/css/bootstrap-grid.min.css">
     <link href="/assets/vendor/bootstrap/css/bootstrap-reboot.min.css">

</head>
<body>
  <app-root></app-root>

  <!-- google translator -->
  <script type="text/javascript">
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({pageLanguage: 'en', includedLanguages: 'ar,bn,da,de,el,en,es,fr,gu,id,it,ja,kn,ko,la,lt,ml,mr,nl,pa,pt,ru,ta,te,tr,uk,ur,zh-CN,zh-TW', layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
  }
  </script>
  <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
  <!-- google translator end -->

<!-- <script src="/assets/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/assets/vendor/popper/popper.min.js"></script>
<script src="/assets/vendor/popper/popper-utils.min.js"></script>
<script src="/assets/vendor/jquery/jquery.min.js"></script>
<script src="/assets/vendor/jquery/jquery.slim.min.min.js"></script> -->

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

  <!--Admin Javascript files-->
  <script src="/assets/js/grasp_mobile_progress_circle-1.0.0.min.js"></script>
  <script src="/assets/vendor/jquery.cookie/jquery.cookie.js"> </script>
  <script src="/assets/vendor/chart.js/Chart.min.js"></script>
  <script src="/assets/vendor/jquery-validation/jquery.validate.min.js"></script>
  <script src="/assets/vendor/malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="/assets/js/charts-home.js"></script>
  <script src="/assets/js/charts-custom.js"></script>

  <!-- Main File-->
  <script src="/assets/js/front.js"></script>

  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.concat.min.js"></script> -->
  <script type="text/javascript">
   const dynamic_JS = ({
  sno,
  optionVal,
  price
}) => `<tr><td>${sno}</td>  <td><select name="selectProduct" class="form-control" selected="${optionVal}"><option value="0"> -- Select One --</option><option value="1"> IPhone </option><option value="2"> MAC </option><option value="3"> Windows </option></select></td>  <td><input type="text" class="form-control" value="${price}" title="" ></td>  <td><button type="button" class="remove-row btn btn-info glyphicon glyphicon-remove" ></button></td>  </tr>`;
// onclick=\'removeRow(this)\' 

//window.onload=function(){}
$(document).ready(function() {
  var template_add = $('#hidden-template').text();

  function render(props) {
    return function(tok, i) {
      return (i % 2) ? props[tok] : tok;
    };
  }
  var items = [{
    sno: '1',
    optionVal: '0',
    price: '0'
  }];
  var dynamic_HTML = template_add.split(/\$\{(.+?)\}/g);

  $('tbody').append(items.map(function(item) {
    return dynamic_HTML.map(render(item)).join('');
  }));

});

// https://stackoverflow.com/a/35592412/5081877
$('table#productTable').on('input propertychange',' > tbody > tr > td:nth-child(3) > input', function() {
  $.each($('input[type=text]'), function() {
    this.value = this.value.replace(/[^0-9]/g, '');
  });
});


$('.add-new').on('click', function() {
  $("#productTable").each(function() {

    var tr_last = $('tbody > tr:last', this).clone();
    var td_no = tr_last.find('td:first');
    var serialNumber = parseInt(td_no.text()) + 1;


    // https://stackoverflow.com/a/6588327/5081877
    var tr_first_input = $('tbody > tr:first > td:nth-child(3) > input');
    var tr_first_price = parseFloat(tr_first_input.val()) || 0;
    console.dir(tr_first_price);

    totalamount += tr_first_price;
    $('#totalAdd').text(totalamount);

    var tr_first_selected = $('tbody > tr:first > td:nth-child(2) > select option').filter(":selected");
    // option:selected | .find(":selected") ~ .text(), ~.attr('value');
    var selectedValue = tr_first_selected.val(),
      optionText = tr_first_selected.text().trim();
    console.log(' Text : ', optionText);
    console.log('Value : ', selectedValue);

    // https://stackoverflow.com/a/39065147/5081877
    $('tbody', this).append([{
      sno: serialNumber,
      optionVal: selectedValue,
      price: tr_first_price
    }].map(dynamic_JS).join(''));

    var last_optionSel = $('tbody#mainBody > tr:last > td:nth-child(2) > select');
    last_optionSel.val(selectedValue);

    tr_first_input.val(0);

    // https://stackoverflow.com/a/13089959/5081877
    var first_optionSel = $('#productOption');
    //$('tbody > tr:first > td:nth-child(2) > select ');
    first_optionSel.val(0);

    return;
  });
});


var totalamount = 0; // tr#mainRow
$('table#productTable > tbody ').on('keyup', 'input', function(e) {
  var total =
    $(e.delegateTarget)
    .find('input')
    .map(function() {
      return parseFloat($(this).val()) || 0;
    })
    .get()
    .reduce(function(a, b) {
      return a + b;
    });

  $('#total').text(total);
});

// <!-- Remove row - javascript & Jquery -->

$('table#productTable').on('click', '.remove-row', function() {
  //$("#productTable").each(function () {
  // added total minus deleting element price.
  $(this).closest('tr').remove(); // https://stackoverflow.com/a/11553788/5081877
  //$(element).parent().remove();
  //});
});

function removeRow(onclickTAG) {
  // Iterate till we find TR tag. 
  while ((onclickTAG = onclickTAG.parentElement) && onclickTAG.tagName != 'TR');
  onclickTAG.parentElement.removeChild(onclickTAG);
}
// <!-- TEST for last butone element. -->
var butOne = $('tbody#mainBody tr').eq($('tbody#mainBody tr').length - 2);
console.log(butOne);
// https://stackoverflow.com/a/7082881/5081877
var mainEle = $("body > table > tbody").children();
var mainEle_butOne = mainEle.eq(mainEle.length - 2);

console.log(mainEle);
console.log(mainEle_butOne);



    
    </script>
</body>
</html>
